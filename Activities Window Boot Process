BOOT PROCESS PRIMER

1. What is the smallest addressable unit on a hard disk?
sector

2. What term describes a logical division of a single storage device?
partition

3. What term describes a formatted storage device that can span 1 or more partitions, has a single file system and is assigned a drive letter?
volume

4. What CLI disk partitioning tool is available in Windows to view and manipulate both partitions and volumes?
diskpart

5. Windows includes 4 critical Kernel-mode components. Which component is a matched pair with the kernel and obfuscates the hardware dependencies from the kernel?
HAL

6. Windows includes 4 critical Kernel-mode components. Which component directs calls from a user-mode process to the kernel services?
Executive

7. This provides an operating system with a software interface to a hardware device
driver

8. What are the two firmware interfaces supported by modern computers and read in the Pre-boot phase of the Windows boot process?
BIOS and UEFI

9. What is the name of the process that spawns SYSTEM?
ntoskrnl

10. In Windows what does the boot sector code load into memory?
bootmgr and winload.exe

11. In Windows 10 what is the name of the boot manager?
bootmgr

12. In Microsoft Vista and later the boot.ini file was replaced by what?
BCD

13. 
TPM

14. During the Windows boot process, what starts BOOT_START device drivers and services with value of 0x0 in the registry key HKLM\SYSTEM\CurrentControlSet\Services?
winload.exe

15. During the Windows boot process, what starts SYSTEM_START device drivers and services with hex value of 0x1 in the registry key HKLM\SYSTEM\CurrentControlSet\Services?
ntoskrnl

16. During the Windows boot process, services.exe starts device drivers and services on demand with what hex value in the registry key HKLM\SYSTEM\CurrentControlSet\Services?
0x0

17. Starting in Windows Vista, what process spawns two additional instances (with identical names), used to initiate session 0 and session 1?
smss

18. Which Windows Vista user session is non-interactive, contains system services and processes and is isolated from the GDI (Graphical Device Interface)
session 0

19. What is the boot process security feature available in UEFI systems, that only allows verified drivers to load?
secure boot

20. To make booting faster, starting with Windows 8, the OS does a partial ________ of the kernel session at shutdown?
hibernate

21. What registry key is responsible for starting services on your machine during the boot process? Flag is the full registry path.
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce

22. When a user logons to a Windows host, authentication will either grant the user access to the local computer only (Local Logon) or the user will also be granted access to a Windows domain (Domain Logon). 
Which logon will the user be authenticated via the Security Accounts Manager (SAM) database?
local

23. What is the parent process of explorer.exe?
userinit

24. What is responsible for handling Windows SAS (secure attention sequence), user profile loading, assignment of security to user shell, and Windows station and desktop protection?
winlogon

25. What critical Windows process is initialized by wininit.exe, is responsible for creating the user's security access token and verifying user logon credentials?
lsass

26. What Microsoft recovery option overwrites the registry key HKLM\System\Select after every successful logon?
last known good

27. What authentication protocol is the default for logging onto an Active Directory domain and features SSO (Single-Sign On), mutual authentication and primarily uses symmetric cryptography?
kerberos

28. In Kerberos the Active Directory controller serves as which major Kerberos component consisting of the Authentication Service (AS) and the Ticket Granting Service (TGS)
key distribution center

29. When would the following Windows registry keys, actions occur? HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit HKLM\Software\Microsoft\Windows 
NT\CurrentVersion\Winlogon\Shell HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify
log in

KERNEL PRIMER

1.The Windows NT Operating System attempts to combine features and benefits of microkernel and monolithic kernel architectures, making it which type of kernel architecture?
hybrid

2. The Linux kernel is an example of what type of kernel architecture?
monolithic

3. Windows operating system name typically differs from its version number. Which Windows version includes Windows 7 and Windows Server 2008R2 and was the 1st version to ship with PowerShell?
6.1

4.Which Windows version includes Windows Server 2016, 2019, 2022, Windows 10 & 11 and includes SMB 3.1.1 support?
10

5. Craft a systeminfo command that only returns the below system info: OS Version: "System OS and Build #" BIOS Version: "Your BIOS Ver"
systeminfo | find "OS Version"


BOOT INIT

1. What is the first process to spawn on Windows systems after the kernel loads?
System

2. What is the Process ID (PID) of the first Windows process?
4

3. What is the second boot process to spawn, that then spawns csrss in both session 0 and session 1?
SMSS

4. What session ID does Windows services operate in?
0

5. What process creates access tokens?
LSASS

6. What is the parent process to all svchosts?
services

7. What process is waiting with high priority for the Secure Attention Sequence (SAS)?
Winlogon

8. What user space process spawns explorer, then dies?
Userinit

9. What is the name of the bootloader, with extension, we are using on all of the Windows machines in this environment?
winload.exe

10. Based on the boot loader from Init_9, which firmware are we using (BIOS or UEFI) in our environment?
BIOS

11. What file saves the memory state to the hard drive when going into hibernation?
hyberfil.sys

12. What bootloader is responsible for restoring the system to its original state after hibernation?
winresume

REMEDIATE

1. The system is booting into safe mode. Identify the flag from the command-line output of the command used to diagnose boot issues.
bcdedit.exe

2. The system is booting into safe mode. Correct that, and reboot into the desktop. The flag is on the desktop.
bcdedit /deletevalue {default} safeboot 

3. Prevent the system restart using the command line, and then identify persistence mechanisms that are reverting the OS and boot loader configurations.
shutdown -a
look in services key in registry

4. Run PowerShell... if you can. Resolve PowerShell dependencies.

HINT: Search the entire file system for the PowerShell .dll and copy it back to where it needs to go. It is hidden in China
search cn
C:\Windows\system32\cn-CN

5. Once you fix and launch PowerShell, the console is changed to a custom layout. Figure out what file is causing this, read the file, and inspect the file that it is referencing.
move System.Management.Automation.dll to correct folder
start powershell from command line
keep typing $profile into error field until error message w/ password appears
$profile.allusersallhosts
look through pdf that opens
