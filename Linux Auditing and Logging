          BASICS

Location : /var/log

Config File : /etc/rsyslog.conf
    Log entries follow syslog standard facility.severity
    tail -n40 /etc/rsyslog.conf - shows rules portion of file
      *.info - every facility code info and more urgent

    facility = what program, or part of system, log is from

    severity = urgency

    Facility Codes:
      0   kernel messages
      1   user-level messages
      2   mail system
      3   system daemons
      4   security/authorization messages
      5   messages generated internally by syslogd
      6   line printer subsystem
      7   network news subsystem
      8   UUCP subsystem
      9   clock daemon
      10  security/authorization messages
      11  FTP daemon
      12  NTP subsystem13|log audit

    Severity Codes:
      0  emerg, panic:  Emergency: system is unusable
      1  alert:         Action must be taken immediately
      2  crit:          Critical conditions
      3  err, error:    Error conditions
      4  warn, warning: Warning conditions
      5  notice:        Normal but significant condition
      6  info:          Informational messages
      7  Debug:         Debug-level messages

Service : /usr/sbin/rsyslogd - logging daemon
    User space daemon - Reads messages written to /dev/log and formats and stores them based on /etc/rsyslog.conf rules.

        syslog() via libc

        kernel ring buffer

        audit records via audit subsystem (auditd)

___________________________________________________________________________

          LOG TYPES

Authentication: 
    /var/log/auth.log - Authentication related events
      tail /var/log/auth.log
      tail -n15 /var/log/auth.log

    /var/run/utmp - Users currently logged in

    /var/log/wtmp - History file for utmp

    /var/log/btmp - Failed login attempts

Application:
    apache - Web Server (dir)

    apt - Package Manager (dir)

    /var/log/mysql.log

System:
    /var/log/messages - Legacy Catch all

    /var/log/syslog - Ubuntu/Debian Catch all

    dmesg = Device Messenger (queires /proc/kmsg)
        display last 5 lines of kernel ring buffer

        Kernel Ring Buffer - Never fills

        First logs generated by the system

________________________________________________________________________

LOG ENUMERATION / MANAGEMENT

Utilize cron jobs / scripts
    logrotate
        /etc/logrotate.conf

________________________________________________________________________________

      USEFUL COMMANDS

tail -f - Continuously show end of file

less /var/log/syslog - View Log in page viewer

logger - Send a user generated message to system Log i.e. Starting Update

> /var/log/messages - Wipes Logs

last -f /var/log{wtmp,btmp} - Needed to view data files

last - w/o arguments displays contents of /var/log/wtmp

_____________________________________________________________________________________

AUDITING VS LOGGING

[kauditd] - runs at the kernel level and can monitor individual syscalls (/sbin/auditd)

auditctl -l - control/config command, list filesystem or system call rules
auditctl -w /AUDITID_DEMO/TEST/test.txt -p wa -k file_watch - create filesystem rules

aureport - summary reports of audit logs

ausearch - query audit logs, show authentication logs
  ausearch -k file_watch | tail -n60 - query logs by key

ausearch -k file_watch | aureport -f -i | tail -n30 - pipe to aureport for formatting



